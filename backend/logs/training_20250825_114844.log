2025-08-25 11:48:44,202 - deepfake_detector - INFO - Starting training with config: TrainingConfig(backbone='resnet50', pretrained=True, dropout=0.5, num_classes=2, input_size=[3, 224, 224], batch_size=32, learning_rate=0.0001, weight_decay=0.0001, epochs=100, warmup_epochs=5, train_ratio=0.7, val_ratio=0.15, num_workers=4, pin_memory=True, patience=15, min_delta=0.0001, grad_clip_value=1.0, data_path='data', output_dir='models', log_dir='logs', use_wandb=False, use_tensorboard=True, use_mlflow=False, use_ensemble=False, ensemble_models=['resnet50', 'efficientnet_b0', 'efficientnet_b3'], model_version='1.0.0', api_host='0.0.0.0', api_port=8000, IMAGENET_MEAN=[0.485, 0.456, 0.406], IMAGENET_STD=[0.229, 0.224, 0.225], resume=False, resume_from=None, resume_best=True, use_mixed_precision=True)
2025-08-25 11:48:44,202 - deepfake_detector - INFO - Setting up data pipeline...
2025-08-25 11:49:48,155 - deepfake_detector - INFO - Dataset: 20583 train, 4410 val, 4412 test
2025-08-25 11:49:48,156 - deepfake_detector - INFO - Classes: ['fake', 'real']
2025-08-25 11:49:48,156 - deepfake_detector - ERROR - Training failed with error: cannot access local variable 'class_counts' where it is not associated with a value
Traceback (most recent call last):
  File "/Users/fahdahalathel/Desktop/ai-detector/backend/train/train_model.py", line 1010, in main
    "dataset.class_counts": dict(class_counts),
                                 ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'class_counts' where it is not associated with a value
2025-08-25 11:49:48,157 - deepfake_detector - INFO - ðŸ§¹ Cleaning up resources...
2025-08-25 11:49:48,157 - deepfake_detector - INFO - ðŸ‘‹ Training session ended
